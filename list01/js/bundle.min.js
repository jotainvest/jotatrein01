jQuery(document).ready(function(){
 function getQueryVariable(name, url) {
 if (!url) url = window.location.href;
 name = name.replace(/[\[\]]/g, "\\$&");
 var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
 results = regex.exec(url);
 if (!results) return null;
 if (!results[2]) return '';
 return decodeURIComponent(results[2].replace(/\+/g, " "));
 }
 var sigla = getQueryVariable("sigla");
 var pgrp = getQueryVariable("pgrp");
 var xpromo = getQueryVariable("xpromo");
 if(pgrp == "s"){
 var Produto = new Produtos(sigla.toUpperCase());
 $('.nome-serie').html(Produto.nome);
 $('.link-serie').attr("href", Produto.link);
 $('.box-pgrp').css('display', 'block');
 $('.bt-oferta, .call_to_action_red').click(function(e){
 e.preventDefault();
 link = $(this).attr('href');
 if(link.indexOf('?') !== -1){
 link = link + "&chap=1&xpromo="+xpromo;
 }
 else{
 link = link + "?chap=1&xpromo="+xpromo;
 }
 Resize();
 $('.modal-autopay').css('display','block');
 $('.bt-confirma-autopay').attr('href', link);
 console.log(link);
 });
 }
 $(window).resize(function(){
 Resize();
 });
 function Resize(){
 heightTela = $(window).height();
 alturaPopup = $('.modal-autopay .popup').height();
 $('.modal-autopay .popup').css('margin-top',(heightTela/2) - (alturaPopup/2));
 }
});
// importScripts('https://cdn.onesignal.com/sdks/OneSignalSDKWorker.js');
// OneSignal
var OneSignal = window.OneSignal || [];
OneSignal.push(function() {
 OneSignal.init({
 appId: "0315eec2-49f0-4824-9d28-0c8f549aa9de",
 autoRegister: false,
 persistNotification: false,
 notifyButton: {
 enable: false,
 }
 // welcomeNotification: {
 // title: 'Publicação especial liberada!',
 // message: 'Clique aqui e veja agora',
 // url: 'https://www.empiricus.com.br/publicacoes/viver-de-renda-sb/?xpromo=XE-MIL-ONES-VDR-X-X-PP-X-X'
 // },
 // promptOptions: {
 // siteName: 'Empiricus',
 // actionMessage: 'Deseja receber atualizações em primeira mão sobre investimentos?',
 // exampleNotificationTitle: 'Exemplo de notificação',
 // exampleNotificationMessage: 'As notificações irão aparecer em seu computador',
 // exampleNotificationCaption: '(você pode se descadastrar a qualquer momento)',
 // acceptButtonText: 'Aceitar',
 // cancelButtonText: 'Não, obrigado'
 // }
 });
// OneSignal.showHttpPrompt();
// OneSignal.on('notificationPermissionChange', function(permissionChange) {
// var currentPermission = permissionChange.to;
// console.log('New permission state:', currentPermission);
// });
 OneSignal.on('subscriptionChange', function (isSubscribed) {
 console.log("The user's subscription state is now:", isSubscribed);
 });
});
window.SQPlayer;
var SQVideo = {
 blockSelector: document.querySelector('#bt-play'),
 callToActionSelector: document.querySelector('#hid'),
 post_slug: undefined,
 timeToShowButton: 2000,
 init() {
 SQVideo.commons();
 },
 add(opts) {
 this.post_slug = opts.post_slug;
 this.timeToShowButton = opts.timeToShowButton;
 if(opts.source == 'youtube')
 this.youtube.create(opts);
 },
 commons() {
 var tag = document.createElement('script');
 tag.src = "https://www.youtube.com/iframe_api";
 var firstScriptTag = document.getElementsByTagName('script')[0];
 firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
 function Resize() {
 var hPlayer = $('.video').height();
 var wPlayer = $('.video').width();
 $('#bt-play').css({
 'width': wPlayer,
 'height': hPlayer
 });
 }
 Resize();
 $(window).resize(function() {
 Resize();
 })
 },
 youtube: {
 playing: false,
 intervalDuration: false,
 data: {
 '25' : false,
 '50' : false,
 '75' : false,
 '100' : false
 },
 create(opts){
 console.log(opts);
 SQPlayer = new YT.Player('player', {
 height: '480',
 width: '853',
 videoId: opts.video_id,
 playerVars: {
 'autoplay': opts.autoplay,
 'controls': opts.controls,
 'showinfo': 0,
 'autohide': 1,
 'fs': 0,
 'rel': 0,
 'modestbranding': 0
 },
 events: {
 'onReady': this.onPlayerReady,
 'onStateChange': this.onPlayerStateChange
 }
 });
 },
 onPlayerReady(e) {
 SQVideo.blockScreen.click();
 SQVideo.callToAction.handler();
 },
 onPlayerStateChange(e) {
 if(SQPlayer && SQPlayer.getPlayerState() === 1) {
 console.log('Tocando 2...')
 SQVideo.pushLayer('Play')
 SQVideo.youtube.playing = true;
 }
 if (e.data == 1) {
 SQVideo.youtube.intervalDuration = setInterval(SQVideo.youtube.onDurationVideo, 1000);
 if(SQVideo.isMobile.iOS())
 setTimeout(SQVideo.callToAction.show, 3000)
 }
 if (readCookie(SQVideo.post_slug)) {
 SQVideo.callToAction.show();
 }
 },
 onDurationVideo() {
 var x = SQPlayer.getCurrentTime(),
 videoDuration = SQPlayer.getDuration();
 var percentVideo = (x * 100) / videoDuration;
 if (percentVideo > 25 && percentVideo < 50 && !SQVideo.youtube.data['25']) {
 SQVideo.youtube.data['25'] = true;
 if (email !== null) atualizaDados(25);
 SQVideo.pushLayer('25%')
 }
 if (percentVideo > 50 && percentVideo < 75 && !SQVideo.youtube.data['50']) {
 SQVideo.youtube.data['50'] = true;
 if (email !== null) atualizaDados(50);
 SQVideo.pushLayer('50%')
 }
 if (percentVideo > 75 && percentVideo < 99 && !SQVideo.youtube.data['75']) {
 SQVideo.youtube.data['75'] = true;
 if (email !== null) atualizaDados(75);
 SQVideo.pushLayer('75%')
 }
 if (percentVideo > 99 && !SQVideo.youtube.data['100']) {
 SQVideo.youtube.data['100'] = true;
 SQVideo.pushLayer('100%')
 }
 if (SQVideo.youtube.data['100'])
 clearInterval(SQVideo.youtube.intervalDuration);
 }
 },
 cookie: {
 done: false,
 create() {
 SQVideo.cookie.done = true;
 createCookie(SQVideo.post_slug, 1, 1);
 }
 },
 callToAction: {
 done: false,
 interval: undefined,
 handler() {
 SQVideo.callToAction.interval = setInterval(SQVideo.callToAction.time, 1000);
 },
 time() {
 console.log(SQPlayer.getCurrentTime());
 if (!SQVideo.cookie.done && SQPlayer.getCurrentTime() > 10)
 SQVideo.cookie.create();
 if (!SQVideo.callToAction.done && SQPlayer.getCurrentTime() > SQVideo.timeToShowButton)
 SQVideo.callToAction.show();
 if(SQVideo.cookie.done && SQVideo.callToAction.done)
 clearInterval(SQVideo.callToAction.interval);
 },
 show() {
 SQVideo.callToAction.done = true;
 SQVideo.callToActionSelector.style.visibility = 'visible';
 },
 },
 //
 blockScreen: {
 click() {
 console.log('click listener');
 SQVideo.blockSelector.addEventListener('click', ()=>{
 console.log('listener');
 if(SQPlayer && !SQVideo.youtube.playing) {
 console.log('play');
 SQPlayer.playVideo();
 SQVideo.youtube.playing = true;
 }
 else if(SQPlayer && SQVideo.youtube.playing) {
 console.log('paused');
 SQPlayer.pauseVideo();
 SQVideo.youtube.playing = false;
 }
 })
 }
 },
 isMobile: {
 Android() {
 return navigator.userAgent.match(/Android/i);
 },
 BlackBerry() {
 return navigator.userAgent.match(/BlackBerry/i);
 },
 iOS() {
 return navigator.userAgent.match(/iPhone|iPad|iPod/i);
 },
 Opera() {
 return navigator.userAgent.match(/Opera Mini/i);
 },
 Windows() {
 return navigator.userAgent.match(/IEMobile/i);
 },
 any() {
 return (this.Android() || this.BlackBerry() || this.iOS() || this.Opera() || this.Windows());
 }
 },
 pushLayer(label) {
 dataLayer.push({
 'event': 'UA_Generic_Event',
 'eventCategory': 'SL',
 'eventAction': 'VSL',
 'eventLabel': label,
 'eventValue': undefined
 });
 }
}
function onYouTubeIframeAPIReady() {
 var controls = 0;
 if (readCookie("mb53v-lucros-b")) {
 controls = 1;
 }
 SQVideo.add({
 video_id:'86DJVDT9gzY',
 source:'youtube',
 autoplay: `1`,
 controls: controls,
 timeToShowButton: `1` /*seconds*/ ,
 post_slug: 'mb53v-lucros-b'
 })
}
window.addEventListener('load', SQVideo.init);
